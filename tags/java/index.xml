<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Java - 标签 - 退思轩</title><link>https://example.com/tags/java/</link><description>Java - 标签 - 退思轩</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>suda.ivywk@gmail.com (Kai Wang)</managingEditor><webMaster>suda.ivywk@gmail.com (Kai Wang)</webMaster><copyright>本作品采用知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议进行许可</copyright><lastBuildDate>Sun, 17 May 2015 11:07:00 +0800</lastBuildDate><atom:link href="https://example.com/tags/java/" rel="self" type="application/rss+xml"/><item><title>2048 游戏制作过程（Java 描述）：第五节、界面美化</title><link>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%BA%94%E8%8A%82%E7%95%8C%E9%9D%A2%E7%BE%8E%E5%8C%96/</link><pubDate>Sun, 17 May 2015 11:07:00 +0800</pubDate><author>作者</author><guid>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%BA%94%E8%8A%82%E7%95%8C%E9%9D%A2%E7%BE%8E%E5%8C%96/</guid><description><![CDATA[<p>这一节，我们将介绍游戏界面的美化以及游戏数据的存储。</p>
<p>首先创建一个 color.xml 资源文件，用来保存每个数字对应的背景色和前景色。右击 res 文件夹，选择 New，单击 Android resource file，输入 color，单击 Next 即可。</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%94%e8%8a%82%e3%80%81%e7%95%8c%e9%9d%a2%e7%be%8e%e5%8c%96/game2048_5_01.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_01.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_01.png" data-sub-html="<h2>新建资源</h2>">
        
    </a><figcaption class="image-caption">新建资源</figcaption>
    </figure>
<p>修改代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg2&#34;</span><span class="nt">&gt;</span>#eee4da<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text2&#34;</span><span class="nt">&gt;</span>#776e65<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg4&#34;</span><span class="nt">&gt;</span>#ede0c8<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text4&#34;</span><span class="nt">&gt;</span>#776e65<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg8&#34;</span><span class="nt">&gt;</span>#f2b179<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text8&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg16&#34;</span><span class="nt">&gt;</span>#f59563<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text16&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg32&#34;</span><span class="nt">&gt;</span>#f67c5f<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text32&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg64&#34;</span><span class="nt">&gt;</span>#f65e3b<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text64&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg128&#34;</span><span class="nt">&gt;</span>#edcf72<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text128&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg256&#34;</span><span class="nt">&gt;</span>#edcc61<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text256&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg512&#34;</span><span class="nt">&gt;</span>#edc850<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text512&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg1024&#34;</span><span class="nt">&gt;</span>#edc53f<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text1024&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bg2048&#34;</span><span class="nt">&gt;</span>#edc22e<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;text2048&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;bgsuper&#34;</span><span class="nt">&gt;</span>#3c3a32<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&#34;textsuper&#34;</span><span class="nt">&gt;</span>#f9f6f2<span class="nt">&lt;/color&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>其中 bg 表示背景色，text 表示前景色，切换到 Card 界面，在 setNumber 中添加如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">            <span class="k">switch</span><span class="o">(</span><span class="n">number</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">case</span> <span class="n">0</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">0x33FFFFFF</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">2</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text2</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg2</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">4</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text4</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg4</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">8</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text8</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg8</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">16</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text16</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg16</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">32</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text32</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg32</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">64</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text64</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg64</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">128</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text128</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg128</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">256</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text256</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg256</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">512</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text512</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg512</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">1024</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text1024</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg1024</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="n">2048</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">text2048</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bg2048</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">default</span><span class="o">:</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">textsuper</span><span class="o">));</span>
                    <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">getResources</span><span class="o">().</span><span class="na">getColor</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">color</span><span class="o">.</span><span class="na">bgsuper</span><span class="o">));</span>
                    <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>运行结果如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%94%e8%8a%82%e3%80%81%e7%95%8c%e9%9d%a2%e7%be%8e%e5%8c%96/game2048_5_05.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_05.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_05.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>游戏局面基本已经完成。接下来，我们来处理一下主界面的布局，切换到activity_main.xml的代码模式，修改如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="err">&lt;</span>?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;&gt;
<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&#34;http://schemas.android.com/apk/res/android&#34;</span>
    <span class="na">android:orientation=</span><span class="s">&#34;vertical&#34;</span>
    <span class="na">android:layout_width=</span><span class="s">&#34;match_parent&#34;</span>
    <span class="na">android:layout_height=</span><span class="s">&#34;match_parent&#34;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;LinearLayout</span>
        <span class="na">android:layout_width=</span><span class="s">&#34;wrap_content&#34;</span>
        <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
        <span class="na">android:orientation=</span><span class="s">&#34;horizontal&#34;</span>
        <span class="na">android:paddingTop=</span><span class="s">&#34;8dp&#34;</span>
        <span class="na">android:paddingBottom=</span><span class="s">&#34;8dp&#34;</span>
        <span class="na">android:layout_gravity=</span><span class="s">&#34;right&#34;</span><span class="nt">&gt;</span>
    
        <span class="nt">&lt;LinearLayout</span>
            <span class="na">android:layout_width=</span><span class="s">&#34;wrap_content&#34;</span>
            <span class="na">android:layout_height=</span><span class="s">&#34;fill_parent&#34;</span>
            <span class="na">android:orientation=</span><span class="s">&#34;vertical&#34;</span>
            <span class="na">android:layout_marginLeft=</span><span class="s">&#34;16dp&#34;</span>
            <span class="na">android:layout_marginRight=</span><span class="s">&#34;8dp&#34;</span><span class="nt">&gt;</span>

            <span class="nt">&lt;TextView</span>
                <span class="na">android:layout_width=</span><span class="s">&#34;fill_parent&#34;</span>
                <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
                <span class="na">android:text=</span><span class="s">&#34;@string/appname&#34;</span>
                <span class="na">android:textSize=</span><span class="s">&#34;84sp&#34;</span>
                <span class="na">android:textColor=</span><span class="s">&#34;#BBADA0&#34;</span>
                <span class="na">android:paddingTop=</span><span class="s">&#34;8dp&#34;</span>
                <span class="na">android:paddingBottom=</span><span class="s">&#34;8dp&#34;</span>
                <span class="na">android:paddingLeft=</span><span class="s">&#34;16dp&#34;</span>
                <span class="na">android:paddingRight=</span><span class="s">&#34;16dp&#34;</span>
                <span class="na">android:gravity=</span><span class="s">&#34;center&#34;</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;/LinearLayout&gt;</span>

        <span class="nt">&lt;LinearLayout</span>
            <span class="na">android:layout_width=</span><span class="s">&#34;wrap_content&#34;</span>
            <span class="na">android:layout_height=</span><span class="s">&#34;fill_parent&#34;</span>
            <span class="na">android:orientation=</span><span class="s">&#34;vertical&#34;</span>
            <span class="na">android:layout_marginLeft=</span><span class="s">&#34;16dp&#34;</span>
            <span class="na">android:layout_marginRight=</span><span class="s">&#34;8dp&#34;</span><span class="nt">&gt;</span>

            <span class="nt">&lt;TextView</span>
                <span class="na">android:layout_width=</span><span class="s">&#34;fill_parent&#34;</span>
                <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
                <span class="na">android:text=</span><span class="s">&#34;@string/score&#34;</span>
                <span class="na">android:textSize=</span><span class="s">&#34;42sp&#34;</span>
                <span class="na">android:textColor=</span><span class="s">&#34;#BBADA0&#34;</span>
                <span class="na">android:paddingTop=</span><span class="s">&#34;8dp&#34;</span>
                <span class="na">android:paddingBottom=</span><span class="s">&#34;8dp&#34;</span>
                <span class="na">android:paddingLeft=</span><span class="s">&#34;16dp&#34;</span>
                <span class="na">android:paddingRight=</span><span class="s">&#34;16dp&#34;</span>
                <span class="na">android:gravity=</span><span class="s">&#34;center&#34;</span> <span class="nt">/&gt;</span>

            <span class="nt">&lt;TextView</span>
                <span class="na">android:id=</span><span class="s">&#34;@+id/tvScore&#34;</span>
                <span class="na">android:layout_width=</span><span class="s">&#34;fill_parent&#34;</span>
                <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
                <span class="na">android:textSize=</span><span class="s">&#34;42sp&#34;</span>
                <span class="na">android:textColor=</span><span class="s">&#34;#BBADA0&#34;</span>
                <span class="na">android:paddingTop=</span><span class="s">&#34;8dp&#34;</span>
                <span class="na">android:paddingBottom=</span><span class="s">&#34;8dp&#34;</span>
                <span class="na">android:paddingLeft=</span><span class="s">&#34;16dp&#34;</span>
                <span class="na">android:paddingRight=</span><span class="s">&#34;16dp&#34;</span>
                <span class="na">android:gravity=</span><span class="s">&#34;center&#34;</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;/LinearLayout&gt;</span>

    <span class="nt">&lt;/LinearLayout&gt;</span>

    <span class="nt">&lt;GridLayout</span>
        <span class="na">android:id=</span><span class="s">&#34;@+id/gameView&#34;</span>
        <span class="na">android:layout_width=</span><span class="s">&#34;fill_parent&#34;</span>
        <span class="na">android:layout_height=</span><span class="s">&#34;0dp&#34;</span>
        <span class="na">android:layout_weight=</span><span class="s">&#34;1&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;GridLayout&gt;</span>

<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>运行结果如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%94%e8%8a%82%e3%80%81%e7%95%8c%e9%9d%a2%e7%be%8e%e5%8c%96/game2048_5_10.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_10.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_10.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>下面，我们需要为 Best 标签添加一些操作，切换到 MainActivity 类，定义一个变量：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="n">score</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvScore</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvBest</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">MainActivity</span> <span class="n">mainActivity</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>为它添加初始化命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

        <span class="n">tvScore</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvScore</span><span class="o">);</span>
        <span class="n">tvBest</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvBest</span><span class="o">);</span>

        <span class="n">mainActivity</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>添加一个方法方便外部访问这个标签，同时定义一个 bestScore 变量用来保存最高分：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showScore</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">tvScore</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">score</span> <span class="o">+</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
        <span class="n">tvBest</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">bestScore</span> <span class="o">+</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addScore</span><span class="o">(</span><span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">score</span> <span class="o">+=</span> <span class="n">s</span><span class="o">;</span>
        <span class="n">showScore</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getScore</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">score</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBestScore</span><span class="o">(</span><span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">bestScore</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
        <span class="n">showScore</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">score</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">bestScore</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvScore</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvBest</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">MainActivity</span> <span class="n">mainActivity</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>切换到 GameView 中添加如下方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">updateBest</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">bestScore</span><span class="o">,</span> <span class="n">score</span><span class="o">;</span>
        <span class="n">SharedPreferences</span> <span class="n">sp</span> <span class="o">=</span> <span class="n">getContext</span><span class="o">().</span><span class="na">getSharedPreferences</span><span class="o">(</span><span class="s">&#34;game2048&#34;</span><span class="o">,</span> <span class="n">Context</span><span class="o">.</span><span class="na">MODE_PRIVATE</span><span class="o">);</span>
        <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">Editoer</span> <span class="n">editor</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="na">edit</span><span class="o">();</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">getScore</span><span class="o">();</span>
        <span class="n">bestScore</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">&#34;best&#34;</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">bestScore</span> <span class="o">&lt;</span> <span class="n">score</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">editor</span><span class="o">.</span><span class="na">putInt</span><span class="o">(</span><span class="s">&#34;best&#34;</span><span class="o">,</span> <span class="n">score</span><span class="o">);</span>
            <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">setBestScore</span><span class="o">(</span><span class="n">score</span><span class="o">);</span>
            <span class="n">editor</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>在每一次加分后都调用该函数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveLeft</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">y</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往右扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，左移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 左移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">updateBest</span><span class="o">();</span>   <span class="c1">// 更新最高分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveRight</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">y</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往左扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，右移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 右移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">updateBest</span><span class="o">();</span>   <span class="c1">// 更新最高分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveUp</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">x</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往下扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，上移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 上移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">updateBest</span><span class="o">();</span>   <span class="c1">// 更新最高分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveDown</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">x</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往上扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，下移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 下移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">updateBest</span><span class="o">();</span>   <span class="c1">// 更新最高分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>最后，我们需要对最高分标签进行初始化，切换到 MainActivity 类，修改代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

        <span class="n">tvScore</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvScore</span><span class="o">);</span>
        <span class="n">tvBest</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvBest</span><span class="o">);</span>

        <span class="n">SharedPreferences</span> <span class="n">sp</span> <span class="o">=</span> <span class="n">getSharedPreferences</span><span class="o">(</span><span class="s">&#34;game2048&#34;</span><span class="o">,</span> <span class="n">Contex</span><span class="o">.</span><span class="na">MODE_PRIVATE</span><span class="o">);</span>

        <span class="n">bestScore</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">&#34;best&#34;</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
        <span class="n">tvBest</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">bestScore</span> <span class="o">+</span> <span class="s">&#34;&#34;</span><span class="o">);</span>

        <span class="n">mainActivity</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>运行结果如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%94%e8%8a%82%e3%80%81%e7%95%8c%e9%9d%a2%e7%be%8e%e5%8c%96/game2048_5_17.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_17.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第五节、界面美化/game2048_5_17.png" data-sub-html="<h2>运行效果</h2>">
        
    </a><figcaption class="image-caption">运行效果</figcaption>
    </figure>
<p>游戏至此已经完工。当然，我们可以为它添加更多的动画特效，留给读者自行操作。</p>
]]></description></item><item><title>2048 游戏制作过程（Java 描述）：第四节、游戏逻辑</title><link>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%B8%B8%E6%88%8F%E9%80%BB%E8%BE%91/</link><pubDate>Fri, 15 May 2015 19:33:00 +0800</pubDate><author>作者</author><guid>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%B8%B8%E6%88%8F%E9%80%BB%E8%BE%91/</guid><description><![CDATA[<p>上一节中，我们已经成功的将卡牌添加到了游戏中，但只是显示在了界面上，并没有保存下来。我们在 GameView 中定义一个二维数组用来保存游戏界面的卡牌。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="n">Card</span><span class="o">[][]</span> <span class="n">cardMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">[</span><span class="n">4</span><span class="o">][</span><span class="n">4</span><span class="o">];</span>  <span class="c1">// 记录游戏
</span></code></pre></td></tr></table>
</div>
</div><p>接下来，我们需要将初始化时候添加的卡片添加到 cardMap 数组中，如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addCards</span><span class="o">(</span><span class="kt">int</span> <span class="n">cardSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Card</span> <span class="n">card</span><span class="o">;</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">card</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
                <span class="n">card</span><span class="o">.</span><span class="na">setNumber</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
                <span class="n">addView</span><span class="o">(</span><span class="n">card</span><span class="o">,</span> <span class="n">cardSzie</span><span class="o">,</span> <span class="n">cardSize</span><span class="o">);</span>
                <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">card</span><span class="o">;</span>   <span class="c1">// 添加卡片
</span><span class="c1"></span>            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>这样一来，我们就将游戏界面记录下来了。</p>
<p>但是上一节中，我们一下子就生成了 16 张卡片，这和平时游戏的时候不一致。而且我们只能生成卡片 2。为了改进它，我们可以定义一个函数 addRandomNumber，表示每次生成的数字（这里我们设置生成 2 和 4 的概率为 9:1）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addRandomNumber</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">emptyPoints</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>    <span class="c1">// 用 0 表示空点
</span><span class="c1"></span>                    <span class="n">emptyPoints</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Point</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">));</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="n">Point</span> <span class="n">point</span> <span class="o">=</span> <span class="n">emptyPoints</span><span class="o">.</span><span class="na">remove</span><span class="o">((</span><span class="kt">int</span><span class="o">)(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">emptyPoints</span><span class="o">.</span><span class="na">size</span><span class="o">()));</span>    <span class="c1">// 随机获取空点
</span><span class="c1"></span>        <span class="n">cardMap</span><span class="o">[</span><span class="n">point</span><span class="o">.</span><span class="na">x</span><span class="o">][</span><span class="n">point</span><span class="o">.</span><span class="na">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">.</span><span class="na">1</span> <span class="o">?</span> <span class="n">2</span> <span class="o">:</span> <span class="n">4</span><span class="o">);</span>   <span class="c1">// 按 9:1 的概率生成 2 和 4
</span><span class="c1"></span>    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>这里用到了一个 emptyPoints 变量，我们需要定义如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="n">Card</span><span class="o">[][]</span> <span class="n">cardMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">[</span><span class="n">4</span><span class="o">][</span><span class="n">4</span><span class="o">];</span>  <span class="c1">// 记录游戏
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">ListL</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">emptyPoints</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>   <span class="c1">// 空点列表
</span></code></pre></td></tr></table>
</div>
</div><p>除此之外，我们还看到在上面的程序中，我们使用 0 表示空点，但是我们并不希望 0 显示在我们的游戏中，因此修改 Card 类的 SetNumber 函数如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">=</span> <span class="n">number</span><span class="o">;</span>   <span class="c1">// 设置数字
</span><span class="c1"></span>
        <span class="k">if</span><span class="o">(</span><span class="n">number</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tvNumber</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">number</span> <span class="o">+</span> <span class="s">&#34;&#34;</span><span class="o">);</span>  <span class="c1">// 设置 tvNumber 文本
</span><span class="c1"></span>        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">tvNumber</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;&#34;</span><span class="o">);</span>  <span class="c1">// 空文本，不显示数字 0
</span><span class="c1"></span>        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>同时，我们需要修改 GameView 中的 addCards 函数，使得一开始都生成空点：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addCards</span><span class="o">(</span><span class="kt">int</span> <span class="n">cardSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Card</span> <span class="n">card</span><span class="o">;</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">card</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
                <span class="n">card</span><span class="o">.</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>  <span class="c1">// 生成空点
</span><span class="c1"></span>                <span class="n">addView</span><span class="o">(</span><span class="n">card</span><span class="o">,</span> <span class="n">cardSzie</span><span class="o">,</span> <span class="n">cardSize</span><span class="o">);</span>
                <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">card</span><span class="o">;</span>   <span class="c1">// 添加卡片
</span><span class="c1"></span>            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来，我们可以开始游戏了，首先定义一个 startGame 函数，同时在 onSizeChanged 事件中调用它，如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onSizeChanged</span><span class="o">(</span><span class="kt">int</span> <span class="n">w</span><span class="o">,</span> <span class="kt">int</span> <span class="n">h</span><span class="o">,</span> <span class="kt">int</span> <span class="n">oldw</span><span class="o">,</span> <span class="kt">int</span> <span class="n">oldh</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSizeChange</span><span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">oldw</span><span class="o">,</span> <span class="n">oldh</span><span class="o">);</span>

        <span class="kt">int</span> <span class="n">cardSize</span> <span class="o">=</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">h</span><span class="o">)</span> <span class="o">-</span><span class="n">10</span><span class="o">)</span> <span class="o">/</span> <span class="n">4</span><span class="o">;</span>    <span class="c1">// 计算卡牌尺寸
</span><span class="c1"></span>        <span class="n">addCards</span><span class="o">(</span><span class="n">cardSize</span><span class="o">);</span>

        <span class="n">startGame</span><span class="o">();</span>    <span class="c1">// 开始游戏
</span><span class="c1"></span>    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>同时，定义 startGame 函数如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">startGame</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空游戏界面
</span><span class="c1"></span>            <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// 初始化两张卡片
</span><span class="c1"></span>        <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="n">addRandomNumber</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>运行查看结果，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e5%9b%9b%e8%8a%82%e3%80%81%e6%b8%b8%e6%88%8f%e9%80%bb%e8%be%91/game2048_4_09.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_09.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_09.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>接下来，我们需要实现游戏的逻辑，也就是方块的合并。我们需要操作 MoveLeft 等四个函数。如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveLeft</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">y</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往右扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，左移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 左移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来的三个方向的移动只需要对上面的代码进行稍微修改即可，MoveRight 如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveRight</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">y</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往左扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，右移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 右移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>MoveUp 函数如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveUp</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">x</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往下扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，上移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 上移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>MoveDown 函数如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveDown</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">x</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往上扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，下移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 下移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>至此，我们的移动功能已基本完成，测试如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e5%9b%9b%e8%8a%82%e3%80%81%e6%b8%b8%e6%88%8f%e9%80%bb%e8%be%91/game2048_4_14.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_14.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_14.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>最后，我们来完成积分的模块，每次操作得分都等于合并方块的数字之和。切换到 MainActivy 类，添加以下代码以获取 tvScore 这个标签：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

        <span class="n">tvScore</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvScore</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvScore</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下去，为了能够在外界操作 MainActivy 中的 tvScore，我们修改代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

        <span class="n">tvScore</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvScore</span><span class="o">);</span>

        <span class="n">mainActivity</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">MainActivity</span> <span class="nf">getMainActivity</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mainActivity</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvScore</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">MainActivity</span> <span class="n">mainActivity</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>最后添加计分变量以及相关的操作函数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">clearScore</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="n">showScore</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showScore</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">tvScore</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">score</span> <span class="o">+</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addScore</span><span class="o">(</span><span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">score</span> <span class="o">+=</span> <span class="n">s</span><span class="o">;</span>
        <span class="n">showScore</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">score</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvScore</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">MainActivity</span> <span class="n">mainActivity</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>接下去，切换到 GameView 中，将下面的代码添加到四个移动操作的相应位置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveLeft</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">y</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往右扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，左移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 左移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveRight</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">y</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往左扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，右移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 右移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveUp</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">x</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往下扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，上移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 上移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveDown</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">x</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往上扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，下移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 下移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来，我们需要在开始的时候清空分数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">startGame</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">clearScore</span><span class="o">();</span>    <span class="c1">// 清零
</span><span class="c1"></span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空游戏界面
</span><span class="c1"></span>            <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// 初始化两张卡片
</span><span class="c1"></span>        <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="n">addRandomNumber</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e5%9b%9b%e8%8a%82%e3%80%81%e6%b8%b8%e6%88%8f%e9%80%bb%e8%be%91/game2048_4_20.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_20.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_20.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>接下去，我们需要在每次操作后都添加新的卡片：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveLeft</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">y</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往右扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，左移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 左移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveRight</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 行循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 列循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">y</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往左扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，右移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 右移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveUp</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">x</span><span class="o">++)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往下扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，上移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 上移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveDown</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>   <span class="c1">// 列循环
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 行循环
</span><span class="c1"></span>                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">;</span> <span class="n">x</span><span class="o">--)</span> <span class="o">{</span>    <span class="c1">// 从当前位置往上扫描
</span><span class="c1"></span>                    <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span>  <span class="c1">// 当前值为 0
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 空位，下移
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>  <span class="c1">// 避免 2 0 2 不合并的情况
</span><span class="c1"></span>                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">{</span>    <span class="c1">// 相同
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">);</span> <span class="c1">// 下移，合并
</span><span class="c1"></span>                        <span class="n">cardMap</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span> <span class="c1">// 清空
</span><span class="c1"></span>                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">getMainActivity</span><span class="o">().</span><span class="na">addScore</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">());</span> <span class="c1">// 加分
</span><span class="c1"></span>                        <span class="n">move</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 已操作
</span><span class="c1"></span>                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">move</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// 如果操作，添加新的卡片
</span><span class="c1"></span>            <span class="n">addRandomNumber</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>其它三种情况请读者自行根据上述代码进行修改。测试结果如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e5%9b%9b%e8%8a%82%e3%80%81%e6%b8%b8%e6%88%8f%e9%80%bb%e8%be%91/game2048_4_22.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_22.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第四节、游戏逻辑/game2048_4_22.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>最后，我们还需要判断游戏是否结束。游戏结束的条件是没有空位并且无法继续合并。定义一个函数 checkGame，checkGame 函数实现如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">checkGame</span><span class="o">()</span> <span class="o">{</span>

        <span class="kt">boolean</span> <span class="n">complete</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 默认游戏结束
</span><span class="c1"></span><span class="nl">
</span><span class="nl">        ALL:</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">getNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">0</span> <span class="o">||</span>
                    <span class="o">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="o">&amp;&amp;</span> <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">1</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">||</span>
                    <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">3</span> <span class="o">&amp;&amp;</span> <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">][</span><span class="n">j</span><span class="o">]))</span> <span class="o">||</span>
                    <span class="o">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="o">&amp;&amp;</span> <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">1</span><span class="o">]))</span> <span class="o">||</span>
                    <span class="o">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">3</span> <span class="o">&amp;&amp;</span> <span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">cardMap</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">1</span><span class="o">])))</span> <span class="o">{</span>
                    <span class="n">complete</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>   <span class="c1">// 游戏未结束
</span><span class="c1"></span>                    <span class="k">break</span> <span class="n">ALL</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">complete</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">new</span> <span class="n">AlertDialog</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">getContext</span><span class="o">()).</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;2048&#34;</span><span class="o">).</span><span class="na">setMessage</span><span class="o">(</span><span class="s">&#34;游戏结束&#34;</span><span class="o">).</span><span class="na">setPositiveButton</span><span class="o">(</span><span class="s">&#34;重新开始&#34;</span><span class="o">,</span>
                <span class="k">new</span> <span class="n">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">which</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">startGame</span><span class="o">();</span>    <span class="c1">// 重新开始
</span><span class="c1"></span>                <span class="o">}</span>
            <span class="o">}).</span><span class="na">show</span><span class="o">();</span>
        <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>至此，游戏的基本框架都已经全部完成，我们将在下一节中介绍分数的保存以及界面的美化。</p>
]]></description></item><item><title>2048 游戏制作过程（Java 描述）：第三节、创建界面</title><link>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%B8%89%E8%8A%82%E5%88%9B%E5%BB%BA%E7%95%8C%E9%9D%A2/</link><pubDate>Thu, 14 May 2015 20:03:00 +0800</pubDate><author>作者</author><guid>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%B8%89%E8%8A%82%E5%88%9B%E5%BB%BA%E7%95%8C%E9%9D%A2/</guid><description><![CDATA[<p>首先，我们要使得我们的程序能够判断用户的手势，一共为上、下、左、右四种。在 GameView 类中添加如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initGameView</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">setOnTouchListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnTouchListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onTouch</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">,</span> <span class="n">MotionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>

                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来，我们来分析一下如何进行手势判断。首先，用户的手势输入应该有两个数据，一个是按下的屏幕位置，一个是放开的屏幕位置。那么我们只需要计算横向和竖向坐标差的绝对值，绝对值较大的一个方向则是用户需求的方向。至于横向中的左右和竖向中的上下，我们可以通过按下和放开的位置的大小进行比较得出。</p>
<p>有了上面的分析，我们开始写代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initGameView</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">setOnTouchListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnTouchListener</span><span class="o">()</span> <span class="o">{</span>

            <span class="kd">private</span> <span class="kt">float</span> <span class="n">startX</span><span class="o">,</span> <span class="n">startY</span><span class="o">;</span>   <span class="c1">// 起始位置
</span><span class="c1"></span>            <span class="kd">private</span> <span class="kt">float</span> <span class="n">endX</span><span class="o">,</span> <span class="n">endY</span><span class="o">;</span>   <span class="c1">// 终了位置
</span><span class="c1"></span>            <span class="kd">private</span> <span class="kt">float</span> <span class="n">offsetX</span><span class="o">,</span> <span class="n">offsetY</span><span class="o">;</span> <span class="c1">// 偏移量
</span><span class="c1"></span>            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onTouch</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">,</span> <span class="n">MotionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
                
                <span class="k">switch</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getAction</span><span class="o">())</span> <span class="o">{</span>
                    <span class="k">case</span> <span class="n">MotionEvent</span><span class="o">.</span><span class="na">ACTION_DOWN</span><span class="o">:</span>
                        <span class="n">startX</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getX</span><span class="o">();</span>
                        <span class="n">startY</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getY</span><span class="o">();</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">case</span> <span class="n">MotionEvent</span><span class="o">.</span><span class="na">ACTION_UP</span><span class="o">:</span>
                        <span class="n">endX</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getX</span><span class="o">();</span>
                        <span class="n">endY</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getY</span><span class="o">();</span>

                        <span class="n">offsetX</span> <span class="o">=</span> <span class="n">endX</span> <span class="o">-</span> <span class="n">startX</span><span class="o">;</span>
                        <span class="n">offsetY</span> <span class="o">=</span> <span class="n">endY</span> <span class="o">-</span> <span class="n">startY</span><span class="o">;</span>

                        <span class="k">if</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">offsetX</span><span class="o">)</span> <span class="o">&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">offsetY</span><span class="o">))</span> <span class="o">{</span> <span class="c1">// 水平
</span><span class="c1"></span>                            <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Left&#34;</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&gt;</span> <span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Right&#34;</span><span class="o">);</span>
                            <span class="o">}</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span> <span class="c1">// 垂直
</span><span class="c1"></span>                            <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Up&#34;</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&gt;</span> <span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Down&#34;</span><span class="o">);</span>
                            <span class="o">}</span>
                        <span class="o">}</span>
                <span class="o">}</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>运行程序，进入调试界面，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%89%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e7%95%8c%e9%9d%a2/game2048_3_03.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_03.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_03.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>在窗口中用鼠标左滑，查看 Android Studio 中右下角 Logcat 窗口中的输出信息如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%89%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e7%95%8c%e9%9d%a2/game2048_3_04.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_04.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_04.png" data-sub-html="<h2>方向判断</h2>">
        
    </a><figcaption class="image-caption">方向判断</figcaption>
    </figure>
<p>说明我们的触摸检测已经成功了，接下来我们将四条输出语句换成四个函数。如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">                        <span class="k">if</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">offsetX</span><span class="o">)</span> <span class="o">&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">offsetY</span><span class="o">))</span> <span class="o">{</span> <span class="c1">// 水平
</span><span class="c1"></span>                            <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">MoveLeft</span><span class="o">();</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&gt;</span> <span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">MoveRight</span><span class="o">();</span>
                            <span class="o">}</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span> <span class="c1">// 垂直
</span><span class="c1"></span>                            <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">MoveUp</span><span class="o">();</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">offsetX</span> <span class="o">&gt;</span> <span class="n">5</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">MoveDown</span><span class="o">();</span>
                            <span class="o">}</span>
                        <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>除此之外，我们还需要定义这四个函数，代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveLeft</span><span class="o">()</span> <span class="o">{</span>
        
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveRight</span><span class="o">()</span> <span class="o">{</span>
        
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">MoveUp</span><span class="o">()</span> <span class="o">{</span>
        
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="n">MoveDown</span><span class="o">)</span> <span class="o">{</span>
        
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>至于其中的处理方法，我们将在后续的章节中介绍。至此，我们的 GameView 框架基本能完成了。</p>
<p>接下来，我们使用上一节中的方法，创建一个 Card 类（用来显示游戏中的小方块以及其上的数字），并且让它继承自 FrameLayout，同时添加构造函数。如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ivy.end.game2048</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.content.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.FrameLayout</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Card</span> <span class="kd">extends</span> <span class="n">FrameLayout</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Card</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span> <span class="n">context</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>此外，我们还需要创建几个私有成员变量，保存每张卡片上面的数字以及其它的一些信息：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ivy.end.game2048</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.content.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.FrameLayout</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Card</span> <span class="kd">extends</span> <span class="n">FrameLayout</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Card</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span> <span class="n">context</span><span class="o">;</span>

        <span class="n">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>   <span class="c1">// 初始化数字为 0
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getNumber</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">number</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">=</span> <span class="n">number</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来，我们还需要定义一个变量，用来显示文字，这里我们选用 TextView，代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ivy.end.game2048</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.content.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.FrameLayout</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.TextView</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Card</span> <span class="kd">extends</span> <span class="n">FrameLayout</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Card</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span> <span class="n">context</span><span class="o">;</span>

        <span class="c1">// 初始化 tvNumber
</span><span class="c1"></span>        <span class="n">tvNumber</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextView</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
        <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextSize</span><span class="o">(</span><span class="n">32</span><span class="o">);</span>

        <span class="c1">// 添加 tvNumber
</span><span class="c1"></span>        <span class="n">LayoutParams</span> <span class="n">lp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LayoutParams</span><span class="o">(-</span><span class="n">1</span><span class="o">,</span> <span class="o">-</span><span class="n">1</span><span class="o">);</span>
        <span class="n">addView</span><span class="o">(</span><span class="n">tvNumber</span><span class="o">,</span> <span class="n">lp</span><span class="o">);</span>

        <span class="n">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>   <span class="c1">// 初始化数字为 0
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getNumber</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">number</span><span class="o">;</span>  <span class="c1">// 返回数字
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">=</span> <span class="n">number</span><span class="o">;</span>   <span class="c1">// 设置数字
</span><span class="c1"></span>
        <span class="n">tvNumber</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">number</span> <span class="o">+</span> <span class="s">&#34;&#34;</span><span class="o">);</span>  <span class="c1">// 设置 tvNumber 文本
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="c1">// 保存数字
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">tvNumber</span><span class="o">;</span>  <span class="c1">// 显示数字
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下去我们需要添加一些函数用来判断两个 Card 的值是否相等，以方便后期的折叠操作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Card</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">getNumber</span><span class="o">()</span> <span class="o">==</span> <span class="n">o</span><span class="o">.</span><span class="na">getNumber</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>至此，我们游戏的基本元素已经基本完成，接下来我们需要进行组装。首先，我们需要获得卡片的宽高，这是由于不同手机分辨率不同，为了适配各类型的手机。在 GameView 中添加如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onSizeChanged</span><span class="o">(</span><span class="kt">int</span> <span class="n">w</span><span class="o">,</span> <span class="kt">int</span> <span class="n">h</span><span class="o">,</span> <span class="kt">int</span> <span class="n">oldw</span><span class="o">,</span> <span class="kt">int</span> <span class="n">oldh</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSizeChange</span><span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">oldw</span><span class="o">,</span> <span class="n">oldh</span><span class="o">);</span>

        <span class="kt">int</span> <span class="n">cardSize</span> <span class="o">=</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">h</span><span class="o">)</span> <span class="o">-</span><span class="n">10</span><span class="o">)</span> <span class="o">/</span> <span class="n">4</span><span class="o">;</span>    <span class="c1">// 计算卡牌尺寸
</span><span class="c1"></span>        <span class="n">addCards</span><span class="o">(</span><span class="n">cardSize</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>除此之外，我们还需要添加一个 addCards 函数，将卡片添加进来：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addCards</span><span class="o">(</span><span class="kt">int</span> <span class="n">cardSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Card</span> <span class="n">card</span><span class="o">;</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
        <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span>
            <span class="o">{</span>
                <span class="n">card</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
                <span class="n">card</span><span class="o">.</span><span class="na">setNumber</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
                <span class="n">addView</span><span class="o">(</span><span class="n">card</span><span class="o">,</span> <span class="n">cardSzie</span><span class="o">,</span> <span class="n">cardSize</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接着，我们需要将这个 GameView 调整为每行四列，在 initGameView 中添加如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initGameView</span><span class="o">()</span> <span class="o">{</span>
        
        <span class="n">setCOlumnCount</span><span class="o">(</span><span class="n">4</span><span class="o">);</span>  <span class="c1">// 设置列数
</span></code></pre></td></tr></table>
</div>
</div><p>此时，我们可以运行来看一下效果：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%89%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e7%95%8c%e9%9d%a2/game2048_3_14.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_14.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_14.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>至此，我们已经完成了加入卡片的功能，接下来，我们需要使得卡牌居中放置，切换到 Card 类，修改构造函数代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Card</span> <span class="kd">extends</span> <span class="n">FrameLayout</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Card</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span> <span class="n">context</span><span class="o">;</span>

        <span class="c1">// 初始化 tvNumber
</span><span class="c1"></span>        <span class="n">tvNumber</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextView</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
        <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextSize</span><span class="o">(</span><span class="n">32</span><span class="o">);</span>
        <span class="n">tvNumber</span><span class="o">.</span><span class="na">setGravity</span><span class="o">(</span><span class="n">Gravity</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>    <span class="c1">// 居中
</span><span class="c1"></span>
        <span class="c1">// 添加 tvNumber
</span><span class="c1"></span>        <span class="n">LayoutParams</span> <span class="n">lp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LayoutParams</span><span class="o">(-</span><span class="n">1</span><span class="o">,</span> <span class="o">-</span><span class="n">1</span><span class="o">);</span>
        <span class="n">addView</span><span class="o">(</span><span class="n">tvNumber</span><span class="o">,</span> <span class="n">lp</span><span class="o">);</span>

        <span class="n">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>   <span class="c1">// 初始化数字为 0
</span><span class="c1"></span>    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>再测试一下，结果如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%89%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e7%95%8c%e9%9d%a2/game2048_3_16.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_16.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_16.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>接下来，我们需要添加背景，首先在 GameView 的 initGameView 中添加如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initGameView</span><span class="o">()</span> <span class="o">{</span>
        
        <span class="n">setCOlumnCount</span><span class="o">(</span><span class="n">4</span><span class="o">);</span>  <span class="c1">// 设置列数
</span><span class="c1"></span>
        <span class="n">setBackgroundColor</span><span class="o">(</span><span class="n">0xFFBBADA0</span><span class="o">);</span> <span class="c1">// 设置背景
</span></code></pre></td></tr></table>
</div>
</div><p>然后，我们为卡片设置背景，切换到 Card 的构造函数，添加如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Card</span> <span class="kd">extends</span> <span class="n">FrameLayout</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Card</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span> <span class="n">context</span><span class="o">;</span>

        <span class="c1">// 初始化 tvNumber
</span><span class="c1"></span>        <span class="n">tvNumber</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextView</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
        <span class="n">tvNumber</span><span class="o">.</span><span class="na">setTextSize</span><span class="o">(</span><span class="n">32</span><span class="o">);</span>
        <span class="n">tvNumber</span><span class="o">.</span><span class="na">setBackgroundColor</span><span class="o">(</span><span class="n">0x33FFFFFF</span><span class="o">);</span> <span class="c1">// 设置背景
</span><span class="c1"></span>        <span class="n">tvNumber</span><span class="o">.</span><span class="na">setGravity</span><span class="o">(</span><span class="n">Gravity</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>    <span class="c1">// 居中
</span><span class="c1"></span>
        <span class="c1">// 添加 tvNumber
</span><span class="c1"></span>        <span class="n">LayoutParams</span> <span class="n">lp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LayoutParams</span><span class="o">(-</span><span class="n">1</span><span class="o">,</span> <span class="o">-</span><span class="n">1</span><span class="o">);</span>
        <span class="n">addView</span><span class="o">(</span><span class="n">tvNumber</span><span class="o">,</span> <span class="n">lp</span><span class="o">);</span>

        <span class="n">setNumber</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>   <span class="c1">// 初始化数字为 0
</span><span class="c1"></span>    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>运行结果如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%89%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e7%95%8c%e9%9d%a2/game2048_3_19.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_19.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_19.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>显示效果如上图，我们发现卡牌直接没有空格，看起来非常的紧凑，我们可以在 Card 类中这样修改代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">        <span class="c1">// 添加 tvNumber
</span><span class="c1"></span>        <span class="n">LayoutParams</span> <span class="n">lp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LayoutParams</span><span class="o">(-</span><span class="n">1</span><span class="o">,</span> <span class="o">-</span><span class="n">1</span><span class="o">);</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">setMargins</span><span class="o">(</span><span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>    <span class="c1">// 设置偏移量
</span><span class="c1"></span>        <span class="n">addView</span><span class="o">(</span><span class="n">tvNumber</span><span class="o">,</span> <span class="n">lp</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>再次运行程序，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%89%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e7%95%8c%e9%9d%a2/game2048_3_21.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_21.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第三节、创建界面/game2048_3_21.png" data-sub-html="<h2>阶段性效果</h2>">
        
    </a><figcaption class="image-caption">阶段性效果</figcaption>
    </figure>
<p>在下一节中，我们将介绍游戏的内部逻辑。</p>
]]></description></item><item><title>2048 游戏制作过程（Java 描述）：第二节、基本设置</title><link>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%BA%8C%E8%8A%82%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE/</link><pubDate>Thu, 14 May 2015 17:10:00 +0800</pubDate><author>作者</author><guid>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%BA%8C%E8%8A%82%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE/</guid><description><![CDATA[<p>首先，我们需要修改一下应用的图标。准备一个 png 格式的图标文件。如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%8c%e8%8a%82%e3%80%81%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae/game2048_2_01.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_01.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_01.png" data-sub-html="<h2>App 图标</h2>">
        
    </a><figcaption class="image-caption">App 图标</figcaption>
    </figure>
<p>接下来，找到上一节中保存项目的位置，依次展开文件夹中的 2048/Game2048/app/src/main/res 目录，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%8c%e8%8a%82%e3%80%81%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae/game2048_2_02.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_02.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_02.png" data-sub-html="<h2>App 图标</h2>">
        
    </a><figcaption class="image-caption">App 图标</figcaption>
    </figure>
<p>分别将刚才制作完成的图标文件更改名字为 ic_launcher.png，并且修改尺寸为 144×144、96×96、72×72、48×48，分别放入 drawable-xxhdip、drawable-xhdpi、drawable-hdpi、drawble-mdpi 文件夹覆盖其中的图标文件。需要用到这么多尺寸的图片，是由于 Android 应用程序需要兼容不同的客户端而引起的。接下来我们打开 Genymotion，并且运行我们的应用，可以发现图标已经被修改：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%8c%e8%8a%82%e3%80%81%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae/game2048_2_03.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_03.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_03.png" data-sub-html="<h2>App 图标</h2>">
        
    </a><figcaption class="image-caption">App 图标</figcaption>
    </figure>
<p>接下来，我们修改游戏显示的名称，我们希望只显示数字“2048”，切换到 Android Studio 界面，在左侧找到 values/strings.xml，双击打开该文件，将其中的 app_name 属性修改为 2048 即可，如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml">    <span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34; ?&gt;</span>
    <span class="nt">&lt;resources&gt;</span>

        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&#34;app_name&#34;</span><span class="nt">&gt;</span>2048<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&#34;hello_world&#34;</span><span class="nt">&gt;</span>Hello world!<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&#34;action_settings&#34;</span><span class="nt">&gt;</span>Settings<span class="nt">&lt;/string&gt;</span>
    
    <span class="nt">&lt;/resources&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>我们再次运行程序，即可发现应用名称已经被修改为“2048”，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%8c%e8%8a%82%e3%80%81%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae/game2048_2_03.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_03.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_03.png" data-sub-html="<h2>App 名称</h2>">
        
    </a><figcaption class="image-caption">App 名称</figcaption>
    </figure>
<p>至此，我们已经完成了对该应用最基本的配置，接下来，我们需要创建最基本的游戏界面。</p>
<p>首先，打开 res/layout/activity_main.xml 文件，将右下角的 Design/Text 选项卡切换到 Text 界面，并且输入以下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="err">&lt;</span>?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;&gt;
<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&#34;http://schemas.android.com/apk/res/android&#34;</span>
    <span class="na">android:orientation=</span><span class="s">&#34;vertical&#34;</span>
    <span class="na">android:layout_width=</span><span class="s">&#34;match_parent&#34;</span>
    <span class="na">android:layout_height=</span><span class="s">&#34;match_parent&#34;</span><span class="nt">&gt;</span>
    
    <span class="nt">&lt;LinearLayout</span>
        <span class="na">android:layout_width=</span><span class="s">&#34;match_parent&#34;</span>
        <span class="na">android:layout_height=</span><span class="s">&#34;match_parent&#34;</span>
        <span class="na">android:orientation=</span><span class="s">&#34;horizontal&#34;</span><span class="nt">&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:layout_width=</span><span class="s">&#34;wrap_content&#34;</span>
            <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
            <span class="na">android:text=</span><span class="s">&#34;Score&#34;</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">&#34;@+id/tvScore&#34;</span>
            <span class="na">android:layout_width=</span><span class="s">&#34;wrap_content&#34;</span>
            <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span> <span class="nt">/&gt;</span>
        
    <span class="nt">&lt;/LinearLayout&gt;</span>

    <span class="nt">&lt;GridLayout</span>
        <span class="na">android:id=</span><span class="s">&#34;@+id/gameView&#34;</span>
        <span class="na">android:layout_width=</span><span class="s">&#34;fill_parent&#34;</span>
        <span class="na">android:layout_height=</span><span class="s">&#34;0dp&#34;</span>
        <span class="na">android:layout_weight=</span><span class="s">&#34;1&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;GridLayout&gt;</span>

<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>我们看到在 andorid:text=&ldquo;Score&rdquo; 这段代码被深黄色包裹了起来，说明有一些修改建议，单击到上面，按下 Alt + Enter，在弹出的对话框中选择 Extract string resource，弹出下图的对话框，在 Resource Name 中输入 score，单击 OK，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%8c%e8%8a%82%e3%80%81%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae/game2048_2_07.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_07.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_07.png" data-sub-html="<h2>新建字符串</h2>">
        
    </a><figcaption class="image-caption">新建字符串</figcaption>
    </figure>
<p>切换到 Design 界面，可以看到，刚才定义的 Score 标签已经显示了出来，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%8c%e8%8a%82%e3%80%81%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae/game2048_2_08.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_08.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_08.png" data-sub-html="<h2>Score 标签</h2>">
        
    </a><figcaption class="image-caption">Score 标签</figcaption>
    </figure>
<p>接下来，我们需要新建一个 GameView 类来保存游戏的布局，并使得它继承自 GridLayout。</p>
<p>首先，我们将 res 文件夹下的 layout 文件夹删除，因为我们需要自己绘制游戏界面，因此不需要用到 xml 布局文件。接下来我们需要创建一个新的类，用来显示当前的游戏界面。右击 com.ivy.end.game2048 文件夹，选择 New，单击 Java Class，输入类名 GameView，让 GameView 类继承自 GridLayout 类，并且定义它的构造函数，如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ivy.end.game2048</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">...</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GameView</span> <span class="kd">extends</span> <span class="n">GridLayout</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">GameView</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">GameView</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">AttributeSet</span> <span class="n">attrs</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">attrs</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">GameView</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">AttributeSet</span> <span class="n">attrs</span><span class="o">,</span> <span class="kt">int</span> <span class="n">defStyle</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">attrs</span><span class="o">,</span> <span class="n">defStyle</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来，我们需要定义一个初始化函数 initGameView，并且使得通过这三个构造函数进入类中都执行初始化函数，修改代码如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ivy.end.game2048</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">...</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GameView</span> <span class="kd">extends</span> <span class="n">GridLayout</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">GameView</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">GameView</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">AttributeSet</span> <span class="n">attrs</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">attrs</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">GameView</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">AttributeSet</span> <span class="n">attrs</span><span class="o">,</span> <span class="kt">int</span> <span class="n">defStyle</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">attrs</span><span class="o">,</span> <span class="n">defStyle</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initGameView</span><span class="o">()</span> <span class="o">{</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来，我们需要将这个类绑定到刚才的 GridLayout 上，切换到 activity_main.xml 文件的 Text 窗口，将 GridLayout 部分代码修改如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;com.ivy.end.game2048.GameView</span>
        <span class="na">android:id=</span><span class="s">&#34;@+id/gameView&#34;</span>
        <span class="na">android:layout_width=</span><span class="s">&#34;fill_parent&#34;</span>
        <span class="na">android:layout_height=</span><span class="s">&#34;0dp&#34;</span>
        <span class="na">android:layout_weight=</span><span class="s">&#34;1&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/com.ivy.end.game2048.GameView&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>至此，我们的布局代码基本完成。运行以后的界面如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%ba%8c%e8%8a%82%e3%80%81%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae/game2048_2_12.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_12.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第二节、基本设置/game2048_2_12.png" data-sub-html="<h2>运行效果</h2>">
        
    </a><figcaption class="image-caption">运行效果</figcaption>
    </figure>
<p>下一节我们将介绍GameView的具体实现。</p>
]]></description></item><item><title>2048 游戏制作过程（Java 描述）：第一节、创建项目</title><link>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%B8%80%E8%8A%82%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE/</link><pubDate>Fri, 08 May 2015 21:42:00 +0800</pubDate><author>作者</author><guid>https://example.com/2015/05/2048-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8Bjava-%E6%8F%8F%E8%BF%B0%E7%AC%AC%E4%B8%80%E8%8A%82%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE/</guid><description><![CDATA[<p>自从关于扫雷游戏制作过程的文章发布后，有同学让我写一些关于移动开发的文章，并且建议以雷电这款游戏为例。然而考虑到该项目对于初学者来说代码量较大，所以暂且不涉及这部分，转而使用较为简单的 2048 游戏作为例子，可能对于初学者来说更容易上手，并且也更容易自己动手实现出来。</p>
<p>本项目已根据文章进度托管在 GitHub 上：<a href="https://github.com/Ivy-End/2048" target="_blank" rel="noopener noreffer">2048</a>，读者可以自行查看。</p>
<p>由于没有 Mac，因此只能介绍关于 Android 平台相关的开发知识。然而进行 Android 开发之前，需要搭建 Android 开发环境，这一步比较有难度的，主要是各个软件的配置较为麻烦，使得很多初学者望而却步。目前主流的 IDE 有 Eclipse 以及 Android Studio，本文将以 Android Studio 作为集成开发环境，对 2048 游戏的开发过程进行详细的介绍。</p>
<p>然而 Android Studio 的配置并不如 Visual Studio 一样简单，下面将简单介绍一下 Android Studio 集成开发环境的部署，具体的细节步骤读者可以查阅相关资料。</p>
<ol>
<li>安装 JDK，根据自己的操作系统选择合适的 JDK 版本，我们常用的是 Windows x64 版本；</li>
<li>安装 Andorid Studio；</li>
<li>启动 Android Studio，配置 Gradle，该部分较为繁琐，需要自行下载对应版本的 Gradle 包，读者可以参考相关资料；</li>
<li>（可选）安装 Genymotion，也可以使用 Android Studio 默认的模拟器，但是速度较慢。</li>
</ol>
<p>至此，假设读者已经配置完成了 Android 开发环境并且能够正常运行了。接下来，我们进行 2048 游戏项目的创建。首先打开 Android Studio，弹出如下图所示的界面：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_01.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_01.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_01.png" data-sub-html="<h2>Android Studio</h2>">
        
    </a><figcaption class="image-caption">Android Studio</figcaption>
    </figure>
<p>单击 Start a new Android Studio project 创建一个新的 Android Studio 项目，弹出如下界面：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_02.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_02.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_02.png" data-sub-html="<h2>Android Studio 创建项目</h2>">
        
    </a><figcaption class="image-caption">Android Studio 创建项目</figcaption>
    </figure>
<p>这里需要填写三个内容：</p>
<ul>
<li>Application name，项目名称，这里我们填写&quot;Game2048&quot;；</li>
<li>Company Domain，开发者信息，常小数点分割每一个部分，读者可以修改这部分的内容为自己的信息；</li>
<li>Project location，项目地址，选择一个用以保存项目文件的位置。</li>
</ul>
<p>单击 Next，进入下一步：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_03.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_03.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_03.png" data-sub-html="<h2>Android Studio 创建项目</h2>">
        
    </a><figcaption class="image-caption">Android Studio 创建项目</figcaption>
    </figure>
<p>这里需要我们选择该项目的使用平台，我们选择默认的 Phone and Tablet，其中的 Minimum SDK 表示所兼容的最低 API 版本，我们保持默认。单击 Next，进入下一步：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_04.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_04.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_04.png" data-sub-html="<h2>Android Studio 创建项目</h2>">
        
    </a><figcaption class="image-caption">Android Studio 创建项目</figcaption>
    </figure>
<p>接下来需要选择应用的初始界面，由于我们的界面需要自己开发，所以这里不需要进行修改，直接默认即可。单击 Next，进入下一步：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_05.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_05.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_05.png" data-sub-html="<h2>Android Studio 创建项目</h2>">
        
    </a><figcaption class="image-caption">Android Studio 创建项目</figcaption>
    </figure>
<p>这里需要我们对上一步默认选择的 Activity 进行一些属性的填写，保持默认，单击 Finish，完成项目的创建，稍作等待后，项目已经新建完成：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_06.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_06.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_06.png" data-sub-html="<h2>Android Studio 项目创建完毕</h2>">
        
    </a><figcaption class="image-caption">Android Studio 项目创建完毕</figcaption>
    </figure>
<p>我们首先打开 Genymotion，界面如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_07.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_07.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_07.png" data-sub-html="<h2>Genymotion</h2>">
        
    </a><figcaption class="image-caption">Genymotion</figcaption>
    </figure>
<p>单击 Start 按钮，启动 Android 模拟器，界面如下：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_08.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_08.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_08.png" data-sub-html="<h2>Genymotion Android 模拟器</h2>">
        
    </a><figcaption class="image-caption">Genymotion Android 模拟器</figcaption>
    </figure>
<p>若一开始打开时显示为横屏模式，只需要单击右侧的旋转屏幕按钮即可切换到竖屏模式。</p>
<p>接下来，我们切换到 Android Studio 中，选择 Run 菜单项中的 Run &lsquo;app&rsquo;，也可以直接按工具栏中的快捷按钮，弹出如下的对话框：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_09.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_09.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_09.png" data-sub-html="<h2>运行 Android App</h2>">
        
    </a><figcaption class="image-caption">运行 Android App</figcaption>
    </figure>
<p>如果我们的 Genymotion 模拟器打开的话，Android Studio 会自动选择它作为默认的调试设备，这里我们直接单击 OK 即可，接着解锁模拟器中的 Android 系统，稍作等待，可以看到运行的 Android 应用：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_10.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_10.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_10.png" data-sub-html="<h2>运行 Android App</h2>">
        
    </a><figcaption class="image-caption">运行 Android App</figcaption>
    </figure>
<p>接下来，我们需要将它的标题栏去掉。切换到 Android Studio 界面，双击打开左侧的 app/manifests 文件夹下的 AndroidManifests.xml 文件，修改高亮行代码如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="err">&lt;</span>?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;&gt;
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&#34;http://schemas.android.com/apk/res/android&#34;</span>
    <span class="na">package=</span><span class="s">&#34;com.ivy.end.game2048&#34;</span> <span class="nt">&gt;</span>

    <span class="nt">&lt;application</span>
        <span class="na">android:allowBackup=</span><span class="s">&#34;true&#34;</span>
        <span class="na">android:icon=</span><span class="s">&#34;@drawable/ic_launcher&#34;</span>
        <span class="na">android:label=</span><span class="s">&#34;Game2048&#34;</span>
        <span class="na">android:theme=</span><span class="s">&#34;@style/Theme.Appcompat.Light.NoActionBar&#34;</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;activity</span>
            <span class="na">android:name=</span><span class="s">&#34;.MainActivity&#34;</span>
            <span class="na">android:label=</span><span class="s">&#34;Game2048&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MAIN&#34;</span> <span class="nt">/&gt;</span>

                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android:intent:category.LAUNCHER&#34;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
    <span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来找到左侧的 app/res/menu 文件夹下的 menu_main.xml，右击 Delete 将其删除，在弹出的对话框中勾选 Safe delete (with usage search) 以及 Search  in comments and strings 这两个复选框，如下图所示：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_12.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_12.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_12.png" data-sub-html="<h2>删除文件</h2>">
        
    </a><figcaption class="image-caption">删除文件</figcaption>
    </figure>
<p>程序显示找到了引用项目，因为我们在主界面中调用了这个菜单，否则不会显示这个菜单。我们单击 Delete Anyway：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_13.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_13.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_13.png" data-sub-html="<h2>删除文件</h2>">
        
    </a><figcaption class="image-caption">删除文件</figcaption>
    </figure>
<p>接下来，双击打开 app/java/com.ivy.end.game2048 文件夹（并非 com.ivy.end.game2048(androidTest)）下的 MainActiviy 文件，将其中多余的代码（即刚才检测到调用了菜单的部分）全部删除，最终结果如下图所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ivy.end.game2048</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">...</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>此时，再次运行程序，即可看到这样的效果：</p>
<figure><a class="lightgallery" href="/images/2015/2048%20%e6%b8%b8%e6%88%8f%e5%88%b6%e4%bd%9c%e8%bf%87%e7%a8%8b%ef%bc%88Java%20%e6%8f%8f%e8%bf%b0%ef%bc%89%ef%bc%9a%e7%ac%ac%e4%b8%80%e8%8a%82%e3%80%81%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae/game2048_1_15.png" title="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_15.png" data-thumbnail="/images/2015/2048 游戏制作过程（Java 描述）：第一节、创建项目/game2048_1_15.png" data-sub-html="<h2>运行效果</h2>">
        
    </a><figcaption class="image-caption">运行效果</figcaption>
    </figure>
<p>下一节将介绍修改 App 的应用图标以及名称，并且进行最基本的界面布局。</p>
]]></description></item></channel></rss>